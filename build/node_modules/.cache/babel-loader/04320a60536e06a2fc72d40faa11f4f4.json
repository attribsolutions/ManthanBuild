{"ast":null,"code":"'use strict';\n\nvar Lib = require('../lib');\n\nvar toImage = require('../plot_api/to_image');\n\nvar fileSaver = require('./filesaver');\n\nvar helpers = require('./helpers');\n/**\n * Plotly.downloadImage\n *\n * @param {object | string | HTML div} gd\n *   can either be a data/layout/config object\n *   or an existing graph <div>\n *   or an id to an existing graph <div>\n * @param {object} opts (see Plotly.toImage in ../plot_api/to_image)\n * @return {promise}\n */\n\n\nfunction downloadImage(gd, opts) {\n  var _gd;\n\n  if (!Lib.isPlainObject(gd)) _gd = Lib.getGraphDiv(gd);\n  opts = opts || {};\n  opts.format = opts.format || 'png';\n  opts.width = opts.width || null;\n  opts.height = opts.height || null;\n  opts.imageDataOnly = true;\n  return new Promise(function (resolve, reject) {\n    if (_gd && _gd._snapshotInProgress) {\n      reject(new Error('Snapshotting already in progress.'));\n    } // see comments within svgtoimg for additional\n    //   discussion of problems with IE\n    //   can now draw to canvas, but CORS tainted canvas\n    //   does not allow toDataURL\n    //   svg format will work though\n\n\n    if (Lib.isIE() && opts.format !== 'svg') {\n      reject(new Error(helpers.MSG_IE_BAD_FORMAT));\n    }\n\n    if (_gd) _gd._snapshotInProgress = true;\n    var promise = toImage(gd, opts);\n    var filename = opts.filename || gd.fn || 'newplot';\n    filename += '.' + opts.format.replace('-', '.');\n    promise.then(function (result) {\n      if (_gd) _gd._snapshotInProgress = false;\n      return fileSaver(result, filename, opts.format);\n    }).then(function (name) {\n      resolve(name);\n    }).catch(function (err) {\n      if (_gd) _gd._snapshotInProgress = false;\n      reject(err);\n    });\n  });\n}\n\nmodule.exports = downloadImage;","map":{"version":3,"names":["Lib","require","toImage","fileSaver","helpers","downloadImage","gd","opts","_gd","isPlainObject","getGraphDiv","format","width","height","imageDataOnly","Promise","resolve","reject","_snapshotInProgress","Error","isIE","MSG_IE_BAD_FORMAT","promise","filename","fn","replace","then","result","name","catch","err","module","exports"],"sources":["D:/Rohit/Git projects/Manthan/node_modules/plotly.js/src/snapshot/download.js"],"sourcesContent":["'use strict';\n\nvar Lib = require('../lib');\n\nvar toImage = require('../plot_api/to_image');\n\nvar fileSaver = require('./filesaver');\nvar helpers = require('./helpers');\n\n/**\n * Plotly.downloadImage\n *\n * @param {object | string | HTML div} gd\n *   can either be a data/layout/config object\n *   or an existing graph <div>\n *   or an id to an existing graph <div>\n * @param {object} opts (see Plotly.toImage in ../plot_api/to_image)\n * @return {promise}\n */\nfunction downloadImage(gd, opts) {\n    var _gd;\n    if(!Lib.isPlainObject(gd)) _gd = Lib.getGraphDiv(gd);\n\n    opts = opts || {};\n    opts.format = opts.format || 'png';\n    opts.width = opts.width || null;\n    opts.height = opts.height || null;\n    opts.imageDataOnly = true;\n\n    return new Promise(function(resolve, reject) {\n        if(_gd && _gd._snapshotInProgress) {\n            reject(new Error('Snapshotting already in progress.'));\n        }\n\n        // see comments within svgtoimg for additional\n        //   discussion of problems with IE\n        //   can now draw to canvas, but CORS tainted canvas\n        //   does not allow toDataURL\n        //   svg format will work though\n        if(Lib.isIE() && opts.format !== 'svg') {\n            reject(new Error(helpers.MSG_IE_BAD_FORMAT));\n        }\n\n        if(_gd) _gd._snapshotInProgress = true;\n        var promise = toImage(gd, opts);\n\n        var filename = opts.filename || gd.fn || 'newplot';\n        filename += '.' + opts.format.replace('-', '.');\n\n        promise.then(function(result) {\n            if(_gd) _gd._snapshotInProgress = false;\n            return fileSaver(result, filename, opts.format);\n        }).then(function(name) {\n            resolve(name);\n        }).catch(function(err) {\n            if(_gd) _gd._snapshotInProgress = false;\n            reject(err);\n        });\n    });\n}\n\nmodule.exports = downloadImage;\n"],"mappings":"AAAA;;AAEA,IAAIA,GAAG,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AAEA,IAAIC,OAAO,GAAGD,OAAO,CAAC,sBAAD,CAArB;;AAEA,IAAIE,SAAS,GAAGF,OAAO,CAAC,aAAD,CAAvB;;AACA,IAAIG,OAAO,GAAGH,OAAO,CAAC,WAAD,CAArB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASI,aAAT,CAAuBC,EAAvB,EAA2BC,IAA3B,EAAiC;EAC7B,IAAIC,GAAJ;;EACA,IAAG,CAACR,GAAG,CAACS,aAAJ,CAAkBH,EAAlB,CAAJ,EAA2BE,GAAG,GAAGR,GAAG,CAACU,WAAJ,CAAgBJ,EAAhB,CAAN;EAE3BC,IAAI,GAAGA,IAAI,IAAI,EAAf;EACAA,IAAI,CAACI,MAAL,GAAcJ,IAAI,CAACI,MAAL,IAAe,KAA7B;EACAJ,IAAI,CAACK,KAAL,GAAaL,IAAI,CAACK,KAAL,IAAc,IAA3B;EACAL,IAAI,CAACM,MAAL,GAAcN,IAAI,CAACM,MAAL,IAAe,IAA7B;EACAN,IAAI,CAACO,aAAL,GAAqB,IAArB;EAEA,OAAO,IAAIC,OAAJ,CAAY,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;IACzC,IAAGT,GAAG,IAAIA,GAAG,CAACU,mBAAd,EAAmC;MAC/BD,MAAM,CAAC,IAAIE,KAAJ,CAAU,mCAAV,CAAD,CAAN;IACH,CAHwC,CAKzC;IACA;IACA;IACA;IACA;;;IACA,IAAGnB,GAAG,CAACoB,IAAJ,MAAcb,IAAI,CAACI,MAAL,KAAgB,KAAjC,EAAwC;MACpCM,MAAM,CAAC,IAAIE,KAAJ,CAAUf,OAAO,CAACiB,iBAAlB,CAAD,CAAN;IACH;;IAED,IAAGb,GAAH,EAAQA,GAAG,CAACU,mBAAJ,GAA0B,IAA1B;IACR,IAAII,OAAO,GAAGpB,OAAO,CAACI,EAAD,EAAKC,IAAL,CAArB;IAEA,IAAIgB,QAAQ,GAAGhB,IAAI,CAACgB,QAAL,IAAiBjB,EAAE,CAACkB,EAApB,IAA0B,SAAzC;IACAD,QAAQ,IAAI,MAAMhB,IAAI,CAACI,MAAL,CAAYc,OAAZ,CAAoB,GAApB,EAAyB,GAAzB,CAAlB;IAEAH,OAAO,CAACI,IAAR,CAAa,UAASC,MAAT,EAAiB;MAC1B,IAAGnB,GAAH,EAAQA,GAAG,CAACU,mBAAJ,GAA0B,KAA1B;MACR,OAAOf,SAAS,CAACwB,MAAD,EAASJ,QAAT,EAAmBhB,IAAI,CAACI,MAAxB,CAAhB;IACH,CAHD,EAGGe,IAHH,CAGQ,UAASE,IAAT,EAAe;MACnBZ,OAAO,CAACY,IAAD,CAAP;IACH,CALD,EAKGC,KALH,CAKS,UAASC,GAAT,EAAc;MACnB,IAAGtB,GAAH,EAAQA,GAAG,CAACU,mBAAJ,GAA0B,KAA1B;MACRD,MAAM,CAACa,GAAD,CAAN;IACH,CARD;EASH,CA7BM,CAAP;AA8BH;;AAEDC,MAAM,CAACC,OAAP,GAAiB3B,aAAjB"},"metadata":{},"sourceType":"script"}